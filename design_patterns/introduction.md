---
title: 设计模式

description: 引言
---

# 我与设计模式

在开始讲具体的设计模式之前，先写一篇软文，介绍一下我的个人情况以及为什么打算以设计模式为主题写一组系列博客。

我本人本科是南大软院，硕士阶段有幸到清华软院进修，主要方向是Apache IoTDB。



## 本科经历与设计模式

本科期间在南大软院，接受了颇具特色的软件工程培养，自我感觉技术方面还不是过硬，但是软件工程素养还是很过关的，我对设计模式的钟爱与强烈的应用意识也是在相关的课程以及相关的实习中培养起来的。



### 软工课上的设计模式

南大软院有一组特色课程——《软件工程与计算I》、《软件工程与计算II》、《软件工程与计算III》，三门课都有大作业，I的大作业是实现一个类似vi的文本编辑器，II的大作业是在既定框架下实现一个影院管理系统，III的大作业是实现一个知识图谱系统。

当时课程I的大作业答辩的时候，考察点有三：功能实现、代码规范、设计模式，前两项我都明白是啥并且也都拿了满分，但是当助教问我“你有没有用设计模式”的时候，我一头雾水，问助教“设计模式是啥？” 助教说“看你这样就是没用，没关系，你以后会知道的”。大一时候还算是认真上课的，我当时就在想这玩意要是讲过我怎么可能完全不知道。出来之后我问我的舍友设计模式那一项他怎么搞的，舍友说“ 用了，网上搜一搜看到了一个命令模式 ”。从那次开始，设计模式这个词就算是被我盯上了。

II的课程上都有专门的课时讲授设计模式，但主要是大家耳熟能详的单例模式、工厂模式、策略模式，比较高阶一点的是MVC模式，讲这个模式是因为当时大作业是写web，这种带GUI的交互系统的设计必然是逃不开MVC的，但是当时由于没尝试过实现MVC模式，所以也完完全全把这玩意学成了黑盒，只知道遵守这样的设计模式，但这个模式在之后的《web前端开发》这门课以及我的一次安卓开发经历中被我整明白了。除了这些具体的设计模式，当时还讲了一堆设计原则，并且还专门出题考了理解和应用，但是当时也只是一知半解，完全感受不到这些知识的用处和意义。（究其原因就是代码写得太少，手动狗头）。最后大作业的检查依然有 设计模式 这一项，这一次虽然自己没怎么用设计模式，但是由于后端开发用的是springboot框架，就走网上搜了几个springboot框架自身所使用的设计模式去当捞分项。

后来慢慢理解了我们当时大一大二时候的大作业考核标准，一看功能实现，二看代码规范（可读性、可修改性），三看设计模式（可扩展性、可维护性、可复用性）。其着力点还是在代码质量和代码管理上，我们从不说我们的算法多么精妙、性能多么优异、复杂度怎么怎么样，老师和我们自己都是以代码漂亮自居，看别的院同学写的代码总是会觉得丑陋。我们信奉得最多的几句话，“代码是用来读的”，“软件是用来改的”，“应对变更”......



### 第一次实习与设计模式

当然课上的学习和课程内的实践终究是有那么点捣鼓玩具的意思，真真让我把设计模式刻在心里的，是大二暑假的实习。当时是在南大软院一位08级学长的创业公司（南京道成网络科技有限公司）写一款安卓小游戏，具体的产出不重要，但是过程中的领悟很重要。那位学长既是我的老板，也是我的mentor，在他的指导下完成了一款数字填色游戏的核心功能的设计与开发。依旧是围绕GUI捣鼓，那么必然逃不开MVC模式了，当时在实现View的状态变更以及业务逻辑计算的时候，经历了从一开始的双向耦合+逻辑混合到之后的抽象与解耦。在讨论怎么把代码写得优雅一些时，当时老板脱口而出“这不就是MVC模式嘛”。当时我专注实现功能的时候，会把很多数据、属性揉在一起，老板看完让我把这些抽一抽分分组各自单独维护，当时年轻的我说了一句“没什么必要吧，功能已经实现了”，然后迎接我的就是老板的谆谆教诲“我不是从功能实现角度跟你讲这件事，我是从软件工程的角度跟你讲这件事”，“现阶段的功能是完成了，但是以后还要迭代还要扩展，这些抽出来后以后就能省很多事，比如......”，“设计模式这门课还是很重要的，很实用”...... 经历过这么一次洗礼，设计模式彻底是被我铭记在脑海里、铭刻在骨头上、融化到血液中（这会儿还没融化，这三句话是高中物理老师喜欢喊的口号）。



### 专门的设计模式课程

软件设计是软件生命周期中的重要阶段，涵盖了概要设计和详细设计。南大软院有一门专门的课程来将软件设计，架构设计与详细设计各占一半的课时，架构设计部分讲授架构质量、架构模式、架构设计方法、架构评审方法，详细设计部分的着力点几乎全部落在了设计模式上。在经历过先前的一段实习后，收获的经验也使得我对与这门课有更好的学习动力与理解思维。

这门课详细讲授了6种设计原则以及18种常用的设计模式，这一次的学习相较于先前软工课程上的学习，更加深入、全面，并且相较于之前，代码经验也更加丰富了，除了从理论层面理解设计模式的精妙，也能够更深入地感受到设计模式的实际应用价值。

除了之前提到的单例模式、工厂模式、策略模式，这次学了很多“名字很别致”的模式，比如桥接模式、组合模式、装饰器模式、模板方法模式...... 当时老师是这么说的“一个领域如何设置门槛，最简单的就是搞一套术语名词”，有的模式老师还特地强调名字不能说错，比如 “模板方法模式” 不是 “模板模式”，“工厂方法模式”、“工厂模式”、“抽象工厂模式”这一套要分清楚。显然这些都是期末考试时候的踩分点。

对18种设计模式的学习，针对每一个模式都会涵盖应用场景、模式原理、模式评价等角度，最终针对18种设计模式还会进行分类与总结。印象里期末备考的时候，花了一天半把设计模式部分啃得透透，当时是1月2号考，1月1号学校图书馆和机房都不开，跟舍友跑出去找了一个自习室备考，最终这门课设计模式的部分应该是完美拿下了。美中不足就是这门课的设计模式部分没有什么实践作业，实践作业都被架构部分占去了。



## Apache IoTDB经历与设计模式

大四完成保研后，确定了到清华软院的IoTDB组学习。由于本科时候web业务系统写多了，而且越写越感觉web后端十分依赖数据库，再加上大三找后端开发实习的时候浅学了许多数据库的内容，于是就决定研究生阶段研究数据库、大数据存储相关的方向。所以在找导师的时候，看到清华在做自己的数据库，毫不犹豫地选了这个组。

当时是大四上的下半学期开始接触和学习Apache IoTDB，毕设主题是Apache IoTDB元数据的持久化管理，也是在实验室一位超级大佬的学长的指导下完成的。这位学长也是南大软院毕业，比我高两级，可以说是嫡系学长了。当时学长跟我说他的技能点主要也点在了设计模式上，我是真的心里一激动，当然学长硕士期间还扩充了大量的大数据系统方面的技能点，我的路线也大抵是这样了。Apache IoTDB的元数据是一棵树，设计的初衷是为了方便传统工业界的用户以他们原有的树型资产管理方式进行数据建模。当时刚接受时，不得不说IoTDB元数据模块的代码算不上漂亮，或者说很简陋，写得很随便。在写毕设代码时，当时的代码确实给我带来了一定的麻烦，可以说当时的代码在可扩展性、可维护性上还是有些欠缺的。为了把这棵树做到内外存联合管理，并且一定程度上优化代码质量，我引入了策略模式、工厂模式、组合模式和桥接模式，这一次也是在上完设计模式课程后首次实际应用这些设计模式，感觉还是蛮自豪的。

在硕士开学正式进组后，我依旧是负责IoTDB元数据模块的开发与维护，跟这棵树斗智斗勇。慢慢地，更多的设计模式逐步被引入进来，模板方法模式、装饰器模式、迭代器模式、享元模式、代理模式...... 这些模式以及相关的代码和应用都将作为我这组设计模式系列博客的主要内容。
